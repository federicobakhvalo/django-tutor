{% extends "base.html" %}

{% block content %}
<div class="grow w-full max-w-6xl m-auto py-4 px-2">
	<h2 class="text-2xl font-semibold mb-4 text-white">История выдачи книг</h2>

	
	<div class="overflow-x-auto rounded-lg border border-gray-700">
		<table class="min-w-full divide-y divide-gray-700">
			<thead class="bg-gray-800">
				<tr>
					<th class="px-4 py-2 text-left text-sm font-medium text-gray-300 uppercase">Книга</th>
					
					<th class="px-4 py-2 text-left text-sm font-medium text-gray-300 uppercase">Читатель</th>
					<th class="px-4 py-2 text-left text-sm font-medium text-gray-300 uppercase">Библиотекарь</th>
					<th class="px-4 py-2 text-left text-sm font-medium text-gray-300 uppercase">Выдано</th>
					<th class="px-4 py-2 text-left text-sm font-medium text-gray-300 uppercase">Возврат</th>
				</tr>
			</thead>
			<tbody class="bg-gray-900 divide-y divide-gray-700">
				{% for loan in loans %}
				<tr class="hover:bg-gray-800">
					<td class="px-4 py-2 text-white text-xs">{{ loan.book.bookname }}</td>
				
					<td class="px-4 py-2 text-white text-xs">{{ loan.reader.first_name }} {{ loan.reader.last_name }}</td>
					<td class="px-4 py-2 text-gray-300 text-xs">
						{% if loan.librarian %}
						{{ loan.librarian.first_name }} {{ loan.librarian.last_name }}
						{% else %}
						-
						{% endif %}
					</td>
					<td class="px-4 py-2 text-gray-300 text-xs">{{ loan.issued_at|date:"d.m.Y H:i" }}</td>
					<td class="px-4 py-2 text-gray-300 text-xs flex items-center justify-between">
						{% if loan.returned_at %}
						{{ loan.returned_at|date:"d.m.Y" }}
						{% else %}
						<span class="text-yellow-400 font-medium">не возвращена</span>
						{% endif %}
						<a href="{% url 'bookloan_item' loan.id %}">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
								d="M15.232 5.232l3.536 3.536M16.5 3.5a2.121 2.121 0 013 3L7 19H4v-3L16.5 3.5z" />
						</svg>
						</a>
					</td>
				</tr>
				{% empty %}
				<tr>
					<td colspan="6" class="px-4 py-4 text-center text-gray-400">Записей нет</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>

	{% if is_paginated %}
	<div class="flex items-center justify-center gap-1 mt-6">
	
		{# Назад #}
		{% if page_obj.has_previous %}
		<a href="?{% if q %}q={{ q }}&{% endif %}page={{ page_obj.previous_page_number }}" class="inline-flex h-9 w-9 items-center justify-center rounded-full
	                  border border-[#303030] bg-[#191919] text-white
	                  hover:bg-[#252525] transition">
			‹
		</a>
		{% else %}
		<span class="inline-flex h-9 w-9 items-center justify-center rounded-full
	                  border border-[#303030] bg-[#191919] text-gray-600 cursor-not-allowed">
			‹
		</span>
		{% endif %}
	
		{# Текущая страница #}
		<span class="inline-flex h-9 min-w-[36px] items-center justify-center rounded-full
	               bg-[#252525] text-sm font-medium text-white px-3">
			{{ page_obj.number }}
		</span>
	
		{# Всего страниц #}
		<span class="text-xs text-gray-400">
			из {{ page_obj.paginator.num_pages }}
		</span>
	
		{# Вперед #}
		{% if page_obj.has_next %}
		<a href="?{% if q %}q={{ q }}&{% endif %}page={{ page_obj.next_page_number }}" class="inline-flex h-9 w-9 items-center justify-center rounded-full
	                  border border-[#303030] bg-[#191919] text-white
	                  hover:bg-[#252525] transition">
			›
		</a>
		{% else %}
		<span class="inline-flex h-9 w-9 items-center justify-center rounded-full
	                  border border-[#303030] bg-[#191919] text-gray-600 cursor-not-allowed">
			›
		</span>
		{% endif %}
	
	</div>
	{% endif %}
</div>
{% endblock %}